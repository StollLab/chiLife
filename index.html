<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>χLife &mdash; χLife  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css?v=61a4c737" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="chilife Functions" href="chilife.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            χLife
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="chilife.html">chilife Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="rotamer_ensemble.html">Side chain ensembles</a></li>
<li class="toctree-l1"><a class="reference internal" href="rotamer_libraries.html">Rotamer Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="molsys.html">Molecular Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="faqs.html">Frequently Asked Questions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">χLife</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">χLife</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="life">
<h1>χLife<a class="headerlink" href="#life" title="Link to this heading"></a></h1>
<blockquote>
<div><p>[!NOTE]</p>
<p>We are pleased to announce a free online workshop about chiLife.</p>
<p>This workshop is held online on Wednesday, May 22, 2024 at 6:00am Pacific Time. The workshop will last about 3 hours.</p>
<p>To participate, please register using the online registration form at <a class="reference external" href="https://forms.gle/r6VHt1LWKhrsK7Ww7">https://forms.gle/r6VHt1LWKhrsK7Ww7</a>.</p>
<p>All registered participants will receive an email with information on how to access the online workshop and materials a few days prior to the workshop. There is no need to install chiLife or Python ahead of time.</p>
<p>Please share this announcement with anyone potentially interested in participating.</p>
<p>We look forward to seeing many of you!</p>
<p>Best regards,
Maxx Tessmer and Stefan Stoll</p>
</div></blockquote>
</section>
<section id="chilife">
<h1>chiLife<a class="headerlink" href="#chilife" title="Link to this heading"></a></h1>
<p>chiLife (or χLife) is a python package for modeling non-canonical amino acid side chain ensembles, primarily site
directed spin labels (SDSLs), and using those ensembles to predict experimental results. The goal of chiLife is to provide a
simple, flexible and interoperable python interface to protein side chain ensemble modeling, allowing for rapid
development of custom analysis and modeling pipelines.  This is facilitated by the use of <code class="docutils literal notranslate"><span class="pre">RotamerEnsemble</span></code> and
<code class="docutils literal notranslate"><span class="pre">SpinLabel</span></code> objects with standard interfaces for all supported side chain types, side chain modeling methods and
protein modeling methods. Flexibility is achieved by allowing users to create and use custom <code class="docutils literal notranslate"><span class="pre">RotamerEnsemble</span></code> and
<code class="docutils literal notranslate"><span class="pre">SpinLabel</span></code> objects as well as custom side chain modeling methods. Interoperability sought by interactions with other
Python-based molecular modeling packages. This enables the use of experimental data, like double electron-electron
resonance (DEER), in other standalone protein modeling applications that allow user defined restraints, such as
pyrosetta and NIH-Xplor.</p>
<section id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Link to this heading"></a></h2>
<p>Stable distributions of chiLife can be installed using <code class="docutils literal notranslate"><span class="pre">pip</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>chiLife
</pre></div>
</div>
<p>Alternatively the development version can be installed by downloading and unpacking the GitHub repository, or using
<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span></code> followed by a standard python setuptools installation.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/mtessmer/chiLife.git
<span class="nb">cd</span><span class="w"> </span>chiLife
pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.<span class="w">   </span><span class="c1"># Install as editable and update using `git pull origin main`</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="chilife-module">
<h2>chiLife Module<a class="headerlink" href="#chilife-module" title="Link to this heading"></a></h2>
<p>The primary feature of chiLife is the <code class="docutils literal notranslate"><span class="pre">SpinLabel</span></code> object, which inherits from the more abstract <code class="docutils literal notranslate"><span class="pre">RotamerEnsemble</span></code>
object. While most people will primarily use <code class="docutils literal notranslate"><span class="pre">SpinLabel</span></code> objects, be aware that most properties and functions
discussed are also functional on <code class="docutils literal notranslate"><span class="pre">RotamerLibrary</span></code> objects as well. <code class="docutils literal notranslate"><span class="pre">SpinLabel</span></code> objects can be created and “attached” to
protein models easily and quickly, allowing for on the fly simulation of distance distributions while modeling, or
scriptable analysis. Notably, attaching a <code class="docutils literal notranslate"><span class="pre">SpinLabel</span></code> to a protein does not alter the protein in any way, allowing the
protein model to retain the native amino acid.</p>
<section id="simple-rotamer-library-based-spinlabel-modeling">
<h3>Simple rotamer-library based SpinLabel modeling<a class="headerlink" href="#simple-rotamer-library-based-spinlabel-modeling" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">src</span> <span class="kn">import</span> <span class="n">chilife</span> <span class="k">as</span> <span class="n">xl</span>

<span class="c1"># Download protein structure from PDB</span>
<span class="n">MBP</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;1omp&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Create Spin lables</span>
<span class="n">SL1</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">SpinLabel</span><span class="p">(</span><span class="s1">&#39;R1M&#39;</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">chain</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">protein</span><span class="o">=</span><span class="n">MBP</span><span class="p">)</span>
<span class="n">SL2</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">SpinLabel</span><span class="p">(</span><span class="s1">&#39;R1M&#39;</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="mi">238</span><span class="p">,</span> <span class="n">chain</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">protein</span><span class="o">=</span><span class="n">MBP</span><span class="p">)</span>

<span class="c1"># Calculate distribution</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">distance_distribution</span><span class="p">(</span><span class="n">SL1</span><span class="p">,</span> <span class="n">SL2</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">)</span>

<span class="c1"># Plot distribution</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Distance ($\AA$)&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference external image-reference" href="https://github.com/StollLab/chiLife/raw/main/img/L20R1_S238R1_Pr.png"><img alt="MBP L20R1 S238R1" src="https://github.com/StollLab/chiLife/raw/main/img/L20R1_S238R1_Pr.png" /></a>
<p>The side chain ensembles can then be saved using a simple <code class="docutils literal notranslate"><span class="pre">save</span></code> function that accepts an arbitrary number of <span class="raw-html-md"><code class="docutils literal"><span class="pre"> RotamerEnsemble</span></code></span>, <code class="docutils literal notranslate"><span class="pre">SpinLabel</span></code>, <code class="docutils literal notranslate"><span class="pre">MDAnalyisis.Universe</span></code> and <code class="docutils literal notranslate"><span class="pre">MDAnalyiss.AtomGroup</span></code> objects. Because
<code class="docutils literal notranslate"><span class="pre">RotamerEnsemble</span></code>/<code class="docutils literal notranslate"><span class="pre">SpinLabel</span></code> objects do not mutate the underlying protein, they are saved as separate multi-state
objects and can be visualized with applications like pymol. If you do wish to permanently alter the underlying protein
structure you can use the <span class="raw-html-md"><a href="#mutating-protein-structures"><code class="docutils literal"><span class="pre">mutate</span></code></a></span> function described below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Save structure</span>
<span class="n">xl</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;MBP_L20R1_S238R1.pdb&#39;</span><span class="p">,</span> <span class="n">SL1</span><span class="p">,</span> <span class="n">SL2</span><span class="p">,</span> <span class="n">MBP</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference external image-reference" href="https://github.com/StollLab/chiLife/raw/main/img/L20R1_S238R1_Structure.png"><img alt="MBP L20R1 S238R1 Structure" src="https://github.com/StollLab/chiLife/raw/main/img/L20R1_S238R1_Structure.png" /></a>
</section>
<section id="mimicking-mmm-and-mtsslwizard">
<h3>Mimicking MMM and MTSSLWizard<a class="headerlink" href="#mimicking-mmm-and-mtsslwizard" title="Link to this heading"></a></h3>
<p>In addition to its own features, chiLife offers spin label modeling methods that mimic the popular MMM and MTSSLWizard
modeling applications.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">chilife</span> <span class="k">as</span> <span class="nn">xl</span>

<span class="n">MBP</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;1omp&#39;</span><span class="p">)</span>
<span class="n">SLmmm</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">SpinLabel</span><span class="o">.</span><span class="n">from_mmm</span><span class="p">(</span><span class="s1">&#39;R1M&#39;</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="mi">238</span><span class="p">,</span> <span class="n">protein</span><span class="o">=</span><span class="n">MBP</span><span class="p">)</span>
<span class="n">SLWiz</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">SpinLabel</span><span class="o">.</span><span class="n">from_wizard</span><span class="p">(</span><span class="s1">&#39;R1M&#39;</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="mi">238</span><span class="p">,</span> <span class="n">protein</span><span class="o">=</span><span class="n">MBP</span><span class="p">,</span>
                                 <span class="n">to_find</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">to_try</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>  <span class="c1"># Equivalent to &#39;quick&#39; search, default is &#39;thorough&#39;</span>
                                 <span class="n">vdw</span><span class="o">=</span><span class="mf">3.4</span><span class="p">,</span> <span class="n">clashes</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="c1"># MTSSLWizard &#39;tight&#39; setting, default is &#39;loose&#39;</span>
                                 <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="off-rotamer-sampling-and-local-repacking">
<h3>Off-rotamer sampling and local repacking<a class="headerlink" href="#off-rotamer-sampling-and-local-repacking" title="Link to this heading"></a></h3>
<p>One of the benefits of chiLife is the variety and customizable nature of spin label modeling methods. This includes
methods to sample side chain conformations that deviate from canonical dihedral angles and fixed rotamer libraries
(Off-rotamer sampling) and methods to repack a <code class="docutils literal notranslate"><span class="pre">SpinLabel</span></code> and it’s neighboring amino acids, and to</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">chilife</span> <span class="k">as</span> <span class="nn">xl</span>

<span class="n">MBP</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;1omp&#39;</span><span class="p">)</span>

<span class="c1"># Create a SpinLabel object using the MTSSLWizard &#39;Accessible Volume&#39; Approach</span>
<span class="n">SL1</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">SpinLabel</span><span class="o">.</span><span class="n">from_wizard</span><span class="p">(</span><span class="s1">&#39;R1M&#39;</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">chain</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">protein</span><span class="o">=</span><span class="n">MBP</span><span class="p">)</span>

<span class="c1"># Create a SpinLabel object by sampling off-rotamer dihedral conformations using the rotamer library as a prior</span>
<span class="n">SL2</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">SpinLabel</span><span class="p">(</span><span class="s1">&#39;R1M&#39;</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="mi">238</span><span class="p">,</span> <span class="n">chain</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">sample</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">protein</span><span class="o">=</span><span class="n">MBP</span><span class="p">)</span>

<span class="c1"># Create a SpinLabel object from a ProEPR.repack trajectory</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">de</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">repack</span><span class="p">(</span><span class="n">SL1</span><span class="p">,</span> <span class="n">SL2</span><span class="p">,</span> <span class="n">protein</span><span class="o">=</span><span class="n">MBP</span><span class="p">)</span>
</pre></div>
</div>
<p>The repack function will perform a Markov chain Monte Carlo sampling repack of the spin labels, <code class="docutils literal notranslate"><span class="pre">SL1</span></code> and <code class="docutils literal notranslate"><span class="pre">SL2</span></code> and
neighboring side chains, returning an <code class="docutils literal notranslate"><span class="pre">MDAnalysis.Universe</span></code> object containing all accepted structures of the MCMC
trajectory, the energy function changes at each acceptance step and new SpinLabel objects attached to the lowest energy
structure of the trajectory.</p>
<p>SpinLabel objects and neighboring side chains can be repacked using off-rotamer sampling by using the <code class="docutils literal notranslate"><span class="pre">off_rotamer=True</span></code>
option. In the event off rotamer sampling is being used for repacking, it is likely that the desired SpinLabel object is
not the default rotamer ensembles attached to the lowest energy structure, but instead the ensemble of side chains
created in the MCMC sampling trajectory. This can be done using the <code class="docutils literal notranslate"><span class="pre">from_trajectory</span></code> class method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a SpinLabel object from a xl.repack trajectory with off-rotamer sampling</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">de</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">repack</span><span class="p">(</span><span class="n">SL1</span><span class="p">,</span> <span class="n">SL2</span><span class="p">,</span> <span class="n">protein</span><span class="o">=</span><span class="n">MBP</span><span class="p">,</span> <span class="n">off_rotamer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">SL1</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">SpinLabel</span><span class="o">.</span><span class="n">from_trajectory</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="mi">238</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>Note: if you are creating a SpinLabel object from a label that is unknown to chilife you will have to specify which
atoms the spin density primarily resides on. this is done with the <code class="docutils literal notranslate"><span class="pre">spin_atoms</span></code> kwarg, e.g.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SL1</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">SpinLabel</span><span class="o">.</span><span class="n">from_trajectory</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="mi">238</span><span class="p">,</span> <span class="n">spin_atoms</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;N1&#39;</span><span class="p">,</span> <span class="s1">&#39;O1&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div></blockquote>
<p>Off rotamer sampling can be controlled on a per dihedral basis when repacking with chiLife by passing a list of bools to
the off_rotamer variable. For example, passing <code class="docutils literal notranslate"><span class="pre">off_rotamer</span> <span class="pre">=</span> <span class="pre">[False,</span> <span class="pre">False,</span> <span class="pre">False,</span> <span class="pre">True,</span> <span class="pre">True]</span></code> will allow for off
rotamer sampling of only &amp;chi;:raw-html-md:<cite>&lt;sub&gt;4&lt;/sub&gt; and &amp;chi;&lt;sub&gt;5&lt;/sub&gt;</cite>.</p>
</section>
<section id="mutating-protein-structures">
<h3>Mutating protein structures<a class="headerlink" href="#mutating-protein-structures" title="Link to this heading"></a></h3>
<p>Sometimes you don’t want a whole rotamer ensembles, you just want a protein structure mutated at a particular site with
the most probable spin label conformer. This can be done easily with the <code class="docutils literal notranslate"><span class="pre">mutate</span></code> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">chilife</span> <span class="k">as</span> <span class="nn">xl</span>

<span class="n">MBP</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;1omp&#39;</span><span class="p">)</span>
<span class="n">SL</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">SpinLabel</span><span class="p">(</span><span class="s1">&#39;R1M&#39;</span><span class="p">,</span> <span class="mi">238</span><span class="p">,</span> <span class="n">protein</span><span class="o">=</span><span class="n">MBP</span><span class="p">)</span>
<span class="n">MBP_S238R1</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">MBP</span><span class="p">,</span> <span class="n">SL</span><span class="p">)</span>
<span class="n">xl</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;MBP_S238R1.pdb&#39;</span><span class="p">,</span> <span class="n">MBP_S238R1</span><span class="p">)</span>
</pre></div>
</div>
<p>chiLife can actually mutate several sites at once, and can mutate canonical amino acids as well.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SL1</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">SpinLabel</span><span class="p">(</span><span class="s1">&#39;R1M&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">protein</span><span class="o">=</span><span class="n">MBP</span><span class="p">)</span>
<span class="n">SL2</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">SpinLabel</span><span class="p">(</span><span class="s1">&#39;R1M&#39;</span><span class="p">,</span> <span class="mi">238</span><span class="p">,</span> <span class="n">protein</span><span class="o">=</span><span class="n">MBP</span><span class="p">)</span>
<span class="n">L284V</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">RotamerEnsemble</span><span class="p">(</span><span class="s1">&#39;VAL&#39;</span><span class="p">,</span> <span class="mi">284</span><span class="p">,</span> <span class="n">protein</span><span class="o">=</span><span class="n">MBP</span><span class="p">)</span>
</pre></div>
</div>
<p>Mtating adjacent sites is best done with the <code class="docutils literal notranslate"><span class="pre">repack</span></code> function to avoid clashes between SpinLabels/RotamerEnsembles.
This will return a trajectory which can be used to pick the last or lowest energy frame as your mutated protein.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">MBP_L284V_L20R1_S238R1</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">repack</span><span class="p">(</span><span class="n">SL1</span><span class="p">,</span> <span class="n">SL2</span><span class="p">,</span> <span class="n">L284V</span><span class="p">,</span> <span class="n">protein</span><span class="o">=</span><span class="n">MBP</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="adding-user-defined-spin-labels">
<h3>Adding user defined spin labels<a class="headerlink" href="#adding-user-defined-spin-labels" title="Link to this heading"></a></h3>
<p>Site directed spin labels, and other non-canonical amino acids, are constantly being developed. Additionally, rotamer
libraries for existing labels continuously undergo incremental improvements or modification to suit particular needs,
e.g. a rotamer library specifically for transmembrane residues. In fact chiLife iteself may be being used to develop
new and improved, or application specific rotamer libraries. To this end chiLife makes it easy to create user defined
spin labels and custom rotamer libraries. To create a custom rotamer library, all that is needed is (1) a pdb file of
the spin label (2) A list of the rotatable dihedral bonds, and (3) a list of the atoms where the spin is.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xl</span><span class="o">.</span><span class="n">create_library</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;TRT_1.0&#39;</span><span class="p">,</span>
                  <span class="n">resname</span><span class="o">=</span><span class="s1">&#39;TRT&#39;</span><span class="p">,</span>
                  <span class="n">pdb</span><span class="o">=</span><span class="s1">&#39;test_data/trt.pdb&#39;</span><span class="p">,</span>
                  <span class="n">dihedral_atoms</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39;CB&#39;</span><span class="p">,</span> <span class="s1">&#39;SG&#39;</span><span class="p">],</span>
                                  <span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39;CB&#39;</span><span class="p">,</span> <span class="s1">&#39;SG&#39;</span><span class="p">,</span> <span class="s1">&#39;SD&#39;</span><span class="p">],</span>
                                  <span class="p">[</span><span class="s1">&#39;CB&#39;</span><span class="p">,</span> <span class="s1">&#39;SG&#39;</span><span class="p">,</span> <span class="s1">&#39;SD&#39;</span><span class="p">,</span> <span class="s1">&#39;CAD&#39;</span><span class="p">],</span>
                                  <span class="p">[</span><span class="s1">&#39;SG&#39;</span><span class="p">,</span> <span class="s1">&#39;SD&#39;</span><span class="p">,</span> <span class="s1">&#39;CAD&#39;</span><span class="p">,</span> <span class="s1">&#39;CAE&#39;</span><span class="p">],</span>
                                  <span class="p">[</span><span class="s1">&#39;SD&#39;</span><span class="p">,</span> <span class="s1">&#39;CAD&#39;</span><span class="p">,</span> <span class="s1">&#39;CAE&#39;</span><span class="p">,</span> <span class="s1">&#39;OAC&#39;</span><span class="p">]],</span>
                  <span class="n">spin_atoms</span><span class="o">=</span><span class="s1">&#39;CAQ&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This function will create a portable <code class="docutils literal notranslate"><span class="pre">TRT_1.0_rotlib.npz</span></code> file that can be called specified by the <code class="docutils literal notranslate"><span class="pre">SpinLabel</span></code>
constructor.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xl</span><span class="o">.</span><span class="n">SpinLabel</span><span class="p">(</span><span class="s1">&#39;TRT&#39;</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="mi">238</span><span class="p">,</span> <span class="n">protein</span><span class="o">=</span><span class="n">MBP</span><span class="p">,</span> <span class="n">rotlib</span><span class="o">=</span><span class="s1">&#39;TRT_1.0&#39;</span><span class="p">,</span> <span class="n">sample</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>
</div>
<p>Thus, the file can be easily shared with coworkers, collaborators or with other chiLife users via email or a
forthcoming chiLife rotamer library repository.</p>
<blockquote>
<div><p>NOTE: In the above example the <code class="docutils literal notranslate"><span class="pre">rotlib</span></code> keyword is only used for demonstration purposes. chiLife always searches the
current working directory for rotamer library files first. If there is a <code class="docutils literal notranslate"><span class="pre">XYZ_rotlib.npz</span></code> in the working directory
and you specify <code class="docutils literal notranslate"><span class="pre">xl.SpinLabel('XYZ',</span> <span class="pre">...)</span></code>, chiLife will assume you want to use the <code class="docutils literal notranslate"><span class="pre">XYZ_rotlib.npz</span></code> rotamer library.</p>
</div></blockquote>
<p>User defined labels can be constructed from a single state pdb file or a multi-state PDB file. If constructed from a
single state pdb file a list of dihedral angles and weights can be passed via the <code class="docutils literal notranslate"><span class="pre">dihedrals</span></code> and <code class="docutils literal notranslate"><span class="pre">weigts</span></code> keyword
arguments. For each set of dihedral angles, chiLife create a rotamer and store the whole library using the specified
name. Alternatively using a multi-state PDB file can add some additional information, such as isomeric heterogeneity of
the rotamer library, which will be maintained by chiLife.</p>
<p>For more information on how to use chiLife see <a class="reference external" href="https://stolllab.github.io/chiLife/examples.html">examples</a></p>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading"></a></h2>
<p>For general chiLife use, please cite:</p>
<blockquote>
<div><p>Tessmer, M.H., and S. Stoll. 2023. chiLife: An open-source Python package for in silico spin labeling and integrative
protein modeling. Plos Comput Biol. 19:e1010834.</p>
</div></blockquote>
<p>For use of Off-Rotamer sampling please cite:</p>
<blockquote>
<div><p>Tessmer, M., E.R. Canarie, and S. Stoll. 2022. Comparative evaluation of spin label modeling methods for protein
structural studies. Biophys J.</p>
</div></blockquote>
<p>And when using bifunctional label modeling please cite:</p>
<blockquote>
<div><p>Tessmer, M.H., and S. Stoll. 2023. A Rotamer Library Approach to Modeling Side Chain Ensembles of the Bifunctional
Spin Label RX. Appl. Magn. Reson. 1–14.</p>
</div></blockquote>
<p>Note than many rotamer libraries may also have their own references. Please use the <code class="docutils literal notranslate"><span class="pre">chilfe.rotlib_info()</span></code> function
on the rotamer libraries to check if there is any additional citations that should be referenced when being used.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="chilife.html">chilife Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="chilife.html#module-chilife.chilife">General Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="chilife.html#module-chilife.io">IO Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rotamer_ensemble.html">Side chain ensembles</a><ul>
<li class="toctree-l2"><a class="reference internal" href="rotamer_ensemble.html#rotamerensemble">RotamerEnsemble</a></li>
<li class="toctree-l2"><a class="reference internal" href="rotamer_ensemble.html#spinlabel">SpinLabel</a></li>
<li class="toctree-l2"><a class="reference internal" href="rotamer_ensemble.html#drotamerensemble">dRotamerEnsemble</a></li>
<li class="toctree-l2"><a class="reference internal" href="rotamer_ensemble.html#dspinlabel">dSpinLabel</a></li>
<li class="toctree-l2"><a class="reference internal" href="rotamer_ensemble.html#intrinsiclabel">IntrinsicLabel</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rotamer_libraries.html">Rotamer Libraries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="rotamer_libraries.html#creating-custom-rotamer-libraries">Creating Custom Rotamer Libraries</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="molsys.html">Molecular Systems</a><ul>
<li class="toctree-l2"><a class="reference internal" href="molsys.html#the-molsys-object">The MolSys object</a></li>
<li class="toctree-l2"><a class="reference internal" href="molsys.html#the-molsysic-object">The MolSysIC object</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utils</a><ul>
<li class="toctree-l2"><a class="reference internal" href="numba_utils.html">Numba Utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="protein_utils.html">MolSys Utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="alignments.html">Alignment Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="scoring.html">Scoring</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gallery/01-Basic_Spin_Labeling.html">Basic Spin Labeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="gallery/02-SDSL_Site_Screen.html">SDSL Site Screen</a></li>
<li class="toctree-l2"><a class="reference internal" href="gallery/03-Adding_Custom_Spin_Lables.html">Adding Custom Spin Labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="gallery/04-Repacking_with_MCMC_Sampling.html">Repacking with MCMC Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="gallery/05-Membrane_Docking.html">Membrane Docking</a></li>
<li class="toctree-l2"><a class="reference internal" href="gallery/06-Custom_Energy_Function.html">Custom Energy Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="gallery/09-Bifunctional_Labels.html">Bifunctional Labeling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faqs.html">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="faqs.html#what-is-the-difference-between-a-chilife-rotamerensemble-and-a-chilife-spinlabel">What is the difference between a <code class="xref py py-class docutils literal notranslate"><span class="pre">chilife.RotamerEnsemble</span></code> and a <code class="xref py py-class docutils literal notranslate"><span class="pre">chilife.SpinLabel</span></code>?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faqs.html#how-do-i-use-my-own-pdb-file">How do I use my own PDB file?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faqs.html#what-spin-labels-and-rotamer-libraries-are-available">What spin labels and rotamer libraries are available?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faqs.html#how-do-i-create-my-own-rotamer-libraries">How do I create my own rotamer libraries?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faqs.html#i-created-my-own-rotamer-library-or-got-one-from-a-collaborator-now-how-do-i-use-it">I created my own rotamer library or got one from a collaborator now how do I use it?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faqs.html#where-can-i-find-rotamer-libraries-for-my-spin-label">Where can I find rotamer libraries for my spin label?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faqs.html#how-do-i-tell-chilife-where-i-store-my-personal-rotamer-libraries">How do I tell chiLife where I store my personal rotamer libraries?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faqs.html#how-do-i-emulate-mmm-and-mtsslwizard-behavior">How do I emulate MMM and MTSSLWizard behavior?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faqs.html#how-do-i-view-my-rotamer-spin-label-ensembles">How do I view my rotamer/spin label ensembles?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faqs.html#i-opened-2-pdbs-with-labels-in-pymol-but-it-only-shows-labels-for-one-of-them">I opened 2 PDBs with labels in PyMol but it only shows labels for one of them</a></li>
<li class="toctree-l2"><a class="reference internal" href="faqs.html#why-don-t-my-label-stay-attached-to-my-protein-when-i-align-it-in-pymol">Why don’t my label stay attached to my protein when I align it in pymol?</a></li>
</ul>
</li>
</ul>
</div>
</section>
</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Link to this heading"></a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="chilife.html" class="btn btn-neutral float-right" title="chilife Functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Maxx Tessmer.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>