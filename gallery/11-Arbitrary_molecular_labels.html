<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Arbitrary molecular labels &mdash; chiLife  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Frequently Asked Questions" href="../faqs.html" />
    <link rel="prev" title="Nucleic acid labels" href="10-Nucleic_acid_labels.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            chiLife
              <img src="../_static/chiLife_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../chilife.html">chiLife Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rotamer_ensemble.html">Side Chain Ensembles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rotamer_libraries.html">Rotamer Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../molsys.html">Molecular Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils.html">Utils</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01-Basic_Spin_Labeling.html">Basic Spin Labeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="02-Simple_SDSL_site_pair_screen.html">Simple SDSL site pair screen</a></li>
<li class="toctree-l2"><a class="reference internal" href="03-SDSL_Site_Screen.html">SDSL Site Screen</a></li>
<li class="toctree-l2"><a class="reference internal" href="04-Adding_custom_spin_labels.html">Adding Custom Spin Labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="05-Repacking_with_MCMC_Sampling.html">Repacking with MCMC Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="06-Membrane_Docking.html">Membrane Docking</a></li>
<li class="toctree-l2"><a class="reference internal" href="07-Custom_Energy_Function.html">Custom Energy Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="09-Bifunctional_Labels.html">Bifunctional Labeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="10-Nucleic_acid_labels.html">Nucleic acid labels</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Arbitrary molecular labels</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faqs.html">Frequently Asked Questions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">chiLife</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../examples.html">Examples</a></li>
      <li class="breadcrumb-item active">Arbitrary molecular labels</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/gallery/11-Arbitrary_molecular_labels.nblink.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Arbitrary-molecular-labels">
<h1>Arbitrary molecular labels<a class="headerlink" href="#Arbitrary-molecular-labels" title="Link to this heading"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">chilife</span> <span class="k">as</span> <span class="nn">xl</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;chiLife&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>In some cases, investigators may be interested in labeling not just proteins and nucleic acids, but arbitrary molecules like ligands, or lipids. In this example, we create a rotamer library for labeling cAMP with the 8-NBD fluorophre to demonstrate how this is done.</p>
<p>The first thing we must do is create a PDB file. As a starting template, I have downloaded the <a class="reference external" href="https://www.rcsb.org/ligand/CMP">CMP ligand</a> structure from the PDB. When creating a label for a common ligand, it is always preferable to start with a structure from the PDB since the atom names should be consistent between the rotamer library you are creating and the ligands you will be labeling with it. <strong>If the backbone atom names are not consistent chiLife will not be able to label the ligand
of interest since it won’t know where to attach the label</strong>.</p>
<p><img alt="CMP" src="../_images/CMP.png" /></p>
<p>A PDB file of the CMP ligand is included in this directory. Notably this CMP has no attached label, so we must add a label using pymol or your profered molecular editing program. For this example we will add an NBD fluorphore to the C8 carbon of the purine side chain. Included in this directory are two pdb files corresponding to the raw, pymol built structure (NCA.pdb)</p>
<p><img alt="NCA" src="../_images/NCA.png" /></p>
<p>and the xTB optimized structure (NCA_opt.pdb).</p>
<p><img alt="NCA_opt" src="../_images/NCA_opt.png" /></p>
<p>In general all PDBs used for chiLife rotlibs should be optimized before creating a library.</p>
<p>Now that we have structure we can create a chiLife rotlib. To do this, we will use the <code class="docutils literal notranslate"><span class="pre">create_rotlib</span></code> function, but for an arbitrty ligand we must specify the names of the atom we wish to use for alignment</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aln_atoms</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;C2&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;C1&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;O4&#39;&quot;</span><span class="p">]</span>
<span class="n">spin_atoms</span> <span class="o">=</span> <span class="s2">&quot;O01 N02 N03 C03 C04 C05 C06 C07 C08&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

<span class="n">xl</span><span class="o">.</span><span class="n">create_library</span><span class="p">(</span><span class="s1">&#39;NCA&#39;</span><span class="p">,</span> <span class="s1">&#39;NCA_opt.pdb&#39;</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">aln_atoms</span><span class="o">=</span><span class="n">aln_atoms</span><span class="p">,</span> <span class="n">spin_atoms</span><span class="o">=</span><span class="n">spin_atoms</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xl</span><span class="o">.</span><span class="n">rotlib_info</span><span class="p">(</span><span class="s1">&#39;NCA&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

********************************************************************************
*  Rotamer Library Name:                                                  NCA  *
********************************************************************************
Rotamer Library Name: NCA
File: E:\07)Programming\Python\chiLife\examples\11 - Arbitrary molecular
    lables\NCA_rotlib.npz
Description: None
Comment: None

Length of library: 1
Dihedral definitions:
    [&#34;O4&#39;&#34; &#34;C1&#39;&#34; &#39;N9&#39; &#39;C4&#39;]
    [&#39;N9&#39; &#39;C8&#39; &#39;S01&#39; &#39;C01&#39;]
    [&#39;C8&#39; &#39;S01&#39; &#39;C01&#39; &#39;C02&#39;]
    [&#39;S01&#39; &#39;C01&#39; &#39;C02&#39; &#39;N01&#39;]
    [&#39;C01&#39; &#39;C02&#39; &#39;N01&#39; &#39;C07&#39;]
    [&#39;C02&#39; &#39;N01&#39; &#39;C07&#39; &#39;C06&#39;]
    [&#39;C05&#39; &#39;C04&#39; &#39;N04&#39; &#39;O03&#39;]
Spin atoms: [&#39;O01&#39; &#39;N02&#39; &#39;N03&#39; &#39;C03&#39; &#39;C04&#39; &#39;C05&#39; &#39;C06&#39; &#39;C07&#39; &#39;C08&#39;]
Number of atoms: P: 1, O: 9, C: 18, N: 9, S: 1, H: 18
Number of heavy atoms: 38
Reference: None
chiLife rotlib format: 1.4
********************************************************************************
</pre></div></div>
</div>
<p><img alt="labled" src="../_images/CMP501NCA.png" /></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">distance_distribution</span><span class="p">(</span><span class="o">*</span><span class="n">labels</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;distance ($\rm\AA$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">spine</span><span class="o">==</span><span class="s1">&#39;bottom&#39;</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">xl</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">labels</span><span class="p">,</span> <span class="n">prot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/gallery_11-Arbitrary_molecular_labels_7_0.png" src="../_images/gallery_11-Arbitrary_molecular_labels_7_0.png" />
</div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="10-Nucleic_acid_labels.html" class="btn btn-neutral float-left" title="Nucleic acid labels" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../faqs.html" class="btn btn-neutral float-right" title="Frequently Asked Questions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Maxx Tessmer.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>